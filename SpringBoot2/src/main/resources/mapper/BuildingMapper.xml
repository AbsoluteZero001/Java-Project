<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springboot.springboot2.mapper.BuildingMapper">

    <!-- 查询在用楼栋 -->
    <select id="buildingOfUsed" resultType="com.springboot.springboot2.pojo.Building">
        SELECT building_id AS buildingId,
               building_name AS buildingName,
               building_status AS buildingStatus,
               building_code AS buildingCode,
               building_floors AS buildingFloors,
               completed_date AS completionDate,
               design_life AS designLife,
               ownership
        FROM building
        WHERE building_status = 1
    </select>

    <!-- 根据状态查询楼栋 -->
    <select id="buildingsOfStatus" resultType="com.springboot.springboot2.pojo.Building">
        SELECT building_id AS buildingId,
        building_name AS buildingName,
        building_status AS buildingStatus,
        building_code AS buildingCode,
        building_floors AS buildingFloors,
        completed_date AS completionDate,
        design_life AS designLife,
        ownership
        FROM building
        <where>
            <if test="status != 0">
                building_status = #{status}
            </if>
        </where>
    </select>

    <!-- 插入楼栋 -->
    <insert id="insertBuilding" parameterType="com.springboot.springboot2.pojo.Building" useGeneratedKeys="true" keyProperty="buildingId">
        INSERT INTO building(
            building_name,
            building_code,
            building_status,
            building_floors,
            completed_date,
            design_life,
            ownership
        )
        VALUES(
                  #{buildingName},
                  #{buildingCode},
                  #{buildingStatus},
                  #{buildingFloors},
                  #{completionDate},
                  #{designLife},
                  #{ownership}
              )
    </insert>

    <!-- 可扩展：根据楼栋ID查询单个楼栋 -->
    <select id="getBuildingById" resultType="com.springboot.springboot2.pojo.Building">
        SELECT building_id AS buildingId,
               building_name AS buildingName,
               building_status AS buildingStatus,
               building_code AS buildingCode,
               building_floors AS buildingFloors,
               completed_date AS completionDate,
               design_life AS designLife,
               ownership
        FROM building
        WHERE building_id = #{buildingId}
    </select>

    <!-- 可扩展：分页查询所有楼栋 -->
    <select id="getAllBuildings" resultType="com.springboot.springboot2.pojo.Building">
        SELECT building_id AS buildingId,
               building_name AS buildingName,
               building_status AS buildingStatus,
               building_code AS buildingCode,
               building_floors AS buildingFloors,
               completed_date AS completionDate,
               design_life AS designLife,
               ownership
        FROM building
        ORDER BY building_id ASC
    </select>
    <!-- 批量插入楼栋 -->
    <insert id="insertBuildings" parameterType="java.util.List" useGeneratedKeys="true" keyProperty="buildingId">
        INSERT INTO building(
        building_name,
        building_code,
        building_status,
        building_floors,
        completed_date,
        design_life,
        ownership
        )
        VALUES
        <foreach collection="list" item="item" separator=",">
            (
            #{item.buildingName},
            #{item.buildingCode},
            #{item.buildingStatus},
            #{item.buildingFloors},
            #{item.completionDate},
            #{item.designLife},
            #{item.ownership}
            )
        </foreach>
    </insert>

</mapper>
